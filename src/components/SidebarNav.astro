---
const nav = [
  {
    label: "Case Studies",
    items: [
      { href: "/case-studies/weather-canvas", label: "Weather Canvas" },
    ],
  },
  {
    label: "Context",
    items: [
      { href: "/about", label: "About" },
      { href: "/resume", label: "Resume" },
      { href: "/writing", label: "Writing" },
    ],
  },
];

const pathname = Astro.url.pathname;
const isActive = (href: string) => pathname === href;
const isGroupActive = (items: typeof nav[0]["items"]) =>
  items.some((item) => isActive(item.href));
---

<nav
  aria-label="Primary"
  style={`
    display: flex;
    flex-direction: column;
    height: 100%;
    gap: var(--space-8);
  `}
>
  <!-- Brand -->
  <a
    href="/"
    style={`
      font-size: var(--text-lg);
      font-weight: 600;
      letter-spacing: var(--tracking-tight);
      text-decoration: none;
      color: rgb(var(--color-fg));
    `}
  >
    Manik Rajbhandari
  </a>

  <!-- Nav groups -->
  <div style={`display: flex; flex-direction: column; gap: var(--space-8);`}>
    {nav.map((group) => (
      <div>
        <!-- Group label -->
        <div
          style={`
            margin-bottom: var(--space-3);
            font-size: var(--text-xs);
            letter-spacing: var(--tracking-wide);
            text-transform: uppercase;
            color: ${
              isGroupActive(group.items)
                ? "rgb(var(--color-fg))"
                : "rgb(var(--color-muted))"
            };
          `}
        >
          {group.label}
        </div>

        <ul style="list-style: none; margin: 0; padding: 0;">
          {group.items.map((item) => (
            <li>
              <a
                href={item.href}
                aria-current={isActive(item.href) ? "page" : undefined}
                style={`
                  position: relative;
                  display: block;
                  padding: var(--space-2) var(--space-3);
                  font-size: var(--text-sm);
                  text-decoration: none;
                  border-radius: var(--radius-sm);
                  color: ${
                    isActive(item.href)
                      ? "rgb(var(--color-fg))"
                      : "rgb(var(--color-muted))"
                  };
                `}
              >
                {isActive(item.href) && (
                  <span
                    style={`
                      position: absolute;
                      left: calc(var(--space-4) * -1);
                      top: var(--space-2);
                      font-family: var(--font-mono);
                      font-size: var(--text-xs);
                      color: rgb(var(--color-fg));
                    `}
                  >
                    →
                  </span>
                )}
                {item.label}
              </a>
            </li>
          ))}
        </ul>
      </div>
    ))}
  </div>

  <!-- Footer -->
  <div
    style={`
      margin-top: auto;
      padding-top: var(--space-6);
      font-size: var(--text-xs);
      color: rgb(var(--color-muted));
      font-family: var(--font-mono);
    `}
  >
    v1.0 — 2026
  </div>
</nav>
